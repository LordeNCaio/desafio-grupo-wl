<!DOCTYPE html>
<html lang="br" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Criar Colaborador</title>
    <link th:rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <header>
        <nav th:class="menu">
            <ul th:class="menu__shortcuts">
                <li th:class="menu__shortcut">
                    <a th:class="menu__link" th:href="@{/collaborators}">Voltar</a>
                </li>
            </ul>
        </nav>
    </header>

    <section th:class="section__table">
        <div th:class="container">
            <table th:class="info-table" th:object="${collaborator}">
                <thead th:class="table__head">
                <tr th:class="table__row">
                    <th th:class="table__header">Criar Colaborador</th>
                </tr>
                </thead>
                <tbody th:class="table__body">
                <tr th:class="table__row">
                    <td th:class="table__data">
                        <label th:class="info-table__label" for="fullName">Nome Completo</label>
                        <input th:class="info-table__input" id="fullName" type="text" th:field="*{fullName}" th:value="${collaborator.fullName}">
                    </td>
                </tr>
                <tr th:class="table__row">
                    <td th:class="table__data">
                        <label th:class="info-table__label" for="cpf">CPF</label>
                        <input th:class="info-table__input" id="cpf" type="text" th:field="*{cpf}" th:value="${collaborator.cpf}">
                    </td>
                </tr>
                <tr th:class="table__row">
                    <td th:class="table__data">
                        <button id="save" th:class="send-btn + ' ' + info-table__button"
                                th:with="url = @{/collaborators}, redirect = @{/collaborators}"
                                th:attr="onclick=|createItem('${url}', '${redirect}')|">
                            Adicionar
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </section>

    <script th:inline="javascript">
        function getData(){
            return JSON.stringify({
                "fullName": document.getElementById('fullName').value,
                "cpf": document.getElementById('cpf').value
            })
        }

        function createItem(url, redirect) {
            let xhttp = new XMLHttpRequest();
            xhttp.open("POST", url);
            xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            xhttp.addEventListener('load', () => {
                setTimeout(() => {
                    window.location = redirect;
                }, 500)
            })
            xhttp.send(getData())
        }
    </script>
</body>
</html>